import{m as F,r as y,n as ae,o as we,p as Ce,j as e,q as se,s as Re,P as V,v as q,I as Le,w as O,x as ke,y as Ie,z as Se,A as $,E as _e,f as re,B as N,S as D,e as T,t as R,X as $e,F as z}from"./index-jacESoZy.js";import{T as Pe,a as Ee,b as U,c as Ae,d as Te,e as H,H as De}from"./Helmet-jrb3zR2c.js";import{a as le,b as ze}from"./useViewport-KWVk_UhH.js";import{a as ne,F as te,b as L,c as j,d as b,e as g,S as ie,f as k,o as _,P as oe,n as f,s as h,g as Me,h as Fe,i as W,I as ce,l as Ve,C as Ge}from"./index-B_zni1ZN.js";import{u as Ue,f as X,g as Ke,d as Oe,D as qe,a as Be}from"./PlayerList-CSXDYawH.js";import{u as de}from"./index-Cf1etpk7.js";import"./label-C86ZrwCj.js";import"./SupportListWithFilter-_1y_FIP0.js";/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],We=F("circle",He);/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]],Ze=F("thumbs-down",Xe);/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]],Je=F("thumbs-up",Ye);/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],ea=F("trash-2",Qe);var B="Radio",[aa,ue]=se(B),[sa,ra]=aa(B),pe=y.forwardRef((i,l)=>{const{__scopeRadio:c,name:p,checked:r=!1,required:n,disabled:u,value:d="on",onCheck:o,form:s,...a}=i,[t,m]=y.useState(null),v=q(l,P=>m(P)),w=y.useRef(!1),x=t?s||!!t.closest("form"):!0;return e.jsxs(sa,{scope:c,checked:r,disabled:u,children:[e.jsx(V.button,{type:"button",role:"radio","aria-checked":r,"data-state":ve(r),"data-disabled":u?"":void 0,disabled:u,value:d,...a,ref:v,onClick:O(i.onClick,P=>{r||o==null||o(),x&&(w.current=P.isPropagationStopped(),w.current||P.stopPropagation())})}),x&&e.jsx(me,{control:t,bubbles:!w.current,name:p,value:d,checked:r,required:n,disabled:u,form:s,style:{transform:"translateX(-100%)"}})]})});pe.displayName=B;var xe="RadioIndicator",he=y.forwardRef((i,l)=>{const{__scopeRadio:c,forceMount:p,...r}=i,n=ra(xe,c);return e.jsx(ke,{present:p||n.checked,children:e.jsx(V.span,{"data-state":ve(n.checked),"data-disabled":n.disabled?"":void 0,...r,ref:l})})});he.displayName=xe;var la="RadioBubbleInput",me=y.forwardRef(({__scopeRadio:i,control:l,checked:c,bubbles:p=!0,...r},n)=>{const u=y.useRef(null),d=q(u,n),o=Ie(c),s=Se(l);return y.useEffect(()=>{const a=u.current;if(!a)return;const t=window.HTMLInputElement.prototype,v=Object.getOwnPropertyDescriptor(t,"checked").set;if(o!==c&&v){const w=new Event("click",{bubbles:p});v.call(a,c),a.dispatchEvent(w)}},[o,c,p]),e.jsx(V.input,{type:"radio","aria-hidden":!0,defaultChecked:c,...r,tabIndex:-1,ref:d,style:{...r.style,...s,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});me.displayName=la;function ve(i){return i?"checked":"unchecked"}var na=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],G="RadioGroup",[ta,Ea]=se(G,[ae,ue]),je=ae(),ge=ue(),[ia,oa]=ta(G),fe=y.forwardRef((i,l)=>{const{__scopeRadioGroup:c,name:p,defaultValue:r,value:n,required:u=!1,disabled:d=!1,orientation:o,dir:s,loop:a=!0,onValueChange:t,...m}=i,v=je(c),w=we(s),[x,P]=Ce({prop:n,defaultProp:r??null,onChange:t,caller:G});return e.jsx(ia,{scope:c,name:p,required:u,disabled:d,value:x,onValueChange:P,children:e.jsx(Re,{asChild:!0,...v,orientation:o,dir:w,loop:a,children:e.jsx(V.div,{role:"radiogroup","aria-required":u,"aria-orientation":o,"data-disabled":d?"":void 0,dir:w,...m,ref:l})})})});fe.displayName=G;var be="RadioGroupItem",ye=y.forwardRef((i,l)=>{const{__scopeRadioGroup:c,disabled:p,...r}=i,n=oa(be,c),u=n.disabled||p,d=je(c),o=ge(c),s=y.useRef(null),a=q(l,s),t=n.value===r.value,m=y.useRef(!1);return y.useEffect(()=>{const v=x=>{na.includes(x.key)&&(m.current=!0)},w=()=>m.current=!1;return document.addEventListener("keydown",v),document.addEventListener("keyup",w),()=>{document.removeEventListener("keydown",v),document.removeEventListener("keyup",w)}},[]),e.jsx(Le,{asChild:!0,...d,focusable:!u,active:t,children:e.jsx(pe,{disabled:u,required:n.required,checked:t,...o,...r,name:n.name,ref:a,onCheck:()=>n.onValueChange(r.value),onKeyDown:O(v=>{v.key==="Enter"&&v.preventDefault()}),onFocus:O(r.onFocus,()=>{var v;m.current&&((v=s.current)==null||v.click())})})})});ye.displayName=be;var ca="RadioGroupIndicator",Ne=y.forwardRef((i,l)=>{const{__scopeRadioGroup:c,...p}=i,r=ge(c);return e.jsx(he,{...r,...p,ref:l})});Ne.displayName=ca;var da=fe,ua=ye,pa=Ne;function M({className:i,...l}){return e.jsx(da,{"data-slot":"radio-group",className:$("grid gap-3",i),...l})}function A({className:i,...l}){return e.jsx(ua,{"data-slot":"radio-group-item",className:$("border-input text-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 aspect-square size-4 shrink-0 rounded-full border shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",i),...l,children:e.jsx(pa,{"data-slot":"radio-group-indicator",className:"relative flex items-center justify-center",children:e.jsx(We,{className:"fill-primary absolute top-1/2 left-1/2 size-2 -translate-x-1/2 -translate-y-1/2"})})})}function xa({className:i,type:l,...c}){return e.jsx("input",{type:l,"data-slot":"input",className:$("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",i),...c})}const ha=_e("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function ma({className:i,variant:l,...c}){return e.jsx("div",{"data-slot":"alert",role:"alert",className:$(ha({variant:l}),i),...c})}function va({className:i,...l}){return e.jsx("div",{"data-slot":"alert-title",className:$("col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",i),...l})}const ja=_({player0:_({id:h(),imgUrl:h().optional()}),player1:_({id:h(),imgUrl:h().optional()}),player2:_({id:h(),imgUrl:h().optional()}),support:_({id:h(),imgUrl:h().optional()}),supportLevel:f().min(0).max(4),gameId:h().regex(/^[0-9]\d*$/,"输入正确的id"),server:Me(["zh-CN","zh-TW","ja"]),blue0:h(),blueLevel0:f().min(1).max(3),red0:h(),redLevel0:f().min(1).max(3),greenLevel0:f().min(0).max(3),uraLevel0:f().min(0).max(3),whiteNum0:f().min(0).max(10),blue1:h(),blueLevel1:f().min(1).max(3),red1:h(),redLevel1:f().min(1).max(3),greenLevel1:f().min(0).max(3),uraLevel1:f().min(0).max(3),whiteNum1:f().min(0).max(10),blue2:h(),blueLevel2:f().min(1).max(3),red2:h(),redLevel2:f().min(1).max(3),greenLevel2:f().min(0).max(3),uraLevel2:f().min(0).max(3),whiteNum2:f().min(0).max(10)}),ga=({onFinish:i})=>{const[l,c]=y.useState({}),p=re.get("userId").value(),r=le({resolver:ne(ja),defaultValues:{supportLevel:0,greenLevel0:0,uraLevel0:0,whiteNum0:0,greenLevel1:0,uraLevel1:0,whiteNum1:0,greenLevel2:0,uraLevel2:0,whiteNum2:0}}),n=async d=>{var a,t,m,v,w;let o=Object.assign({},l,d);c(o);const s={...o};s.userId=p,s.updateTime=new Date().getTime(),s.playerId0=(a=d.player0)==null?void 0:a.id,s.playerId1=(t=d.player1)==null?void 0:t.id,s.playerId2=(m=d.player2)==null?void 0:m.id,s.supportId=(v=d.support)==null?void 0:v.id,delete s.support,delete s.player0,delete s.player1,delete s.player2,["0","1","2"].forEach(x=>{s[s[`blue${x}`]]!==void 0?s[s[`blue${x}`]]+=s[`blueLevel${x}`]:s[s[`blue${x}`]]=s[`blueLevel${x}`],s[s[`red${x}`]]!==void 0?s[s[`red${x}`]]+=s[`redLevel${x}`]:s[s[`red${x}`]]=s[`redLevel${x}`],s.white!==void 0?s.white+=s[`whiteNum${x}`]:s.white=s[`whiteNum${x}`],s.uraLevel!==void 0?s.uraLevel+=s[`uraLevel${x}`]:s.uraLevel=s[`uraLevel${x}`]});try{(w=(await T.post("https://urarawin-worker.urarawin.workers.dev/api/sqlite/add",s)).data)!=null&&w.success?(R.success("成功添加"),i()):R.error("有地方出错了")}catch{R.error("提交失败")}},u=()=>["主要","父辈1","父辈2"].map((o,s)=>e.jsxs("div",{className:"space-y-4 p-4 border rounded-lg",children:[e.jsx("h3",{className:"text-lg font-medium",children:o}),e.jsx(L,{control:r.control,name:`player${s}`,render:({field:a})=>e.jsxs(j,{children:[e.jsx(b,{children:"角色"}),e.jsx(g,{children:e.jsx(oe,{value:a.value,onChange:t=>a.onChange(t)})}),e.jsx(k,{})]})}),e.jsx(L,{control:r.control,name:`blue${s}`,render:({field:a})=>e.jsxs(j,{children:[e.jsx(b,{children:"蓝色因子"}),e.jsx(g,{children:e.jsx(M,{onValueChange:a.onChange,value:a.value,className:"flex flex-wrap gap-2",children:Object.entries(D).map(([t,m])=>e.jsxs(j,{className:"flex items-center space-x-1",children:[e.jsx(g,{children:e.jsx(A,{value:t})}),e.jsx(b,{className:"font-normal",children:m})]},t))})}),e.jsx(k,{})]})}),e.jsx(L,{control:r.control,name:`blueLevel${s}`,render:({field:a})=>e.jsxs(j,{children:[e.jsx(b,{children:"蓝色因子星数"}),e.jsx(g,{children:e.jsx("div",{className:"flex gap-1",children:[1,2,3].map(t=>e.jsx(N,{variant:a.value>=t?"default":"outline",type:"button",size:"sm",onClick:()=>a.onChange(t),children:t},t))})}),e.jsx(k,{})]})}),e.jsx(L,{control:r.control,name:`whiteNum${s}`,render:({field:a})=>e.jsxs(j,{children:[e.jsxs(b,{children:["白色因子个数: ",a.value]}),e.jsx(g,{children:e.jsx("div",{className:"flex items-center gap-4",children:e.jsx("input",{type:"range",min:"0",max:"10",value:a.value,onChange:t=>a.onChange(Number(t.target.value)),className:"w-full"})})}),e.jsx(k,{})]})})]},s));return e.jsxs("div",{className:"space-y-6",children:[e.jsx(ma,{children:e.jsx(va,{children:"目前每人只能配置一个种子 自觉维护自己的信息；第一次添加前先刷新 否则可能失败"})}),e.jsx(te,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(n),className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:u()}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(L,{control:r.control,name:"support",render:({field:d})=>e.jsxs(j,{children:[e.jsx(b,{children:"辅助卡"}),e.jsx(g,{children:e.jsx(ie,{value:d.value,onChange:o=>d.onChange(o)})}),e.jsx(k,{})]})}),e.jsx(L,{control:r.control,name:"supportLevel",render:({field:d})=>e.jsxs(j,{children:[e.jsx(b,{children:"辅助卡突破"}),e.jsx(g,{children:e.jsx("div",{className:"flex gap-1",children:[1,2,3,4].map(o=>e.jsx(N,{variant:d.value>=o?"default":"outline",type:"button",size:"sm",onClick:()=>d.onChange(o),children:o},o))})}),e.jsx(k,{})]})}),e.jsx(L,{control:r.control,name:"gameId",render:({field:d})=>e.jsxs(j,{children:[e.jsx(b,{children:"玩家id"}),e.jsx(g,{children:e.jsx(xa,{placeholder:"id",...d})}),e.jsx(k,{})]})}),e.jsx(L,{control:r.control,name:"server",render:({field:d})=>e.jsxs(j,{children:[e.jsx(b,{children:"区服"}),e.jsx(g,{children:e.jsxs(M,{onValueChange:d.onChange,value:d.value,className:"flex gap-2",children:[e.jsxs(j,{className:"flex items-center space-x-1",children:[e.jsx(g,{children:e.jsx(A,{value:"zh-CN"})}),e.jsx(b,{className:"font-normal",children:"简中"})]}),e.jsxs(j,{className:"flex items-center space-x-1",children:[e.jsx(g,{children:e.jsx(A,{value:"zh-TW"})}),e.jsx(b,{className:"font-normal",children:"繁中"})]}),e.jsxs(j,{className:"flex items-center space-x-1",children:[e.jsx(g,{children:e.jsx(A,{value:"ja"})}),e.jsx(b,{className:"font-normal",children:"日服"})]})]})}),e.jsx(k,{})]})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(N,{type:"submit",children:"提交"})})]})})]})},fa=[{value:"speed",label:"速度"},{value:"stamina",label:"耐力"},{value:"power",label:"力量"},{value:"guts",label:"根性"},{value:"wisdom",label:"智力"},{value:"grass",label:"草地/芝"},{value:"dirt",label:"泥地/ダート"},{value:"shortDistance",label:"短距离"},{value:"mile",label:"英里"},{value:"mediumDistance",label:"中距离"},{value:"longDistance",label:"长距离"},{value:"escapeR",label:"逃"},{value:"leadingR",label:"先"},{value:"insertR",label:"差"},{value:"trackingR",label:"追"},{value:"uraLevel",label:"URA"}],ba=[{value:"zh-CN",label:"简中"},{value:"zh-TW",label:"繁中"},{value:"ja",label:"日服"}],ya=_({server:h().min(1,"请选择区服"),player0:_({id:h(),imgUrl:h().optional()}).optional(),support:_({id:h(),imgUrl:h().optional()}).optional(),supportLevel:f().min(0).max(4),p0:W(_({attr:h(),level:f().min(1).max(3)})).optional(),p1:W(_({attr:h(),level:f().min(1).max(9)})).optional()}),Z=({name:i,max:l,control:c})=>{const{fields:p,append:r,remove:n}=ze({control:c,name:i});return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:p.map((u,d)=>e.jsxs("div",{className:"border p-4 rounded-lg space-y-2",children:[e.jsx(L,{control:c,name:`${i}.${d}.attr`,render:({field:o})=>e.jsxs(j,{children:[e.jsx(g,{children:e.jsx(M,{onValueChange:o.onChange,defaultValue:o.value,className:"flex flex-wrap gap-2",children:fa.map(s=>e.jsxs(j,{className:"flex items-center space-x-1",children:[e.jsx(g,{children:e.jsx(A,{value:s.value})}),e.jsx(b,{className:"font-normal",children:s.label})]},s.value))})}),e.jsx(k,{})]})}),e.jsx(L,{control:c,name:`${i}.${d}.level`,render:({field:o})=>e.jsxs(j,{children:[e.jsx(b,{children:"等级"}),e.jsx(g,{children:e.jsx("div",{className:"flex items-center gap-1",children:[...Array(l)].map((s,a)=>e.jsx(N,{variant:o.value>a?"default":"outline",size:"sm",type:"button",onClick:()=>o.onChange(a+1),children:a+1},a))})}),e.jsx(k,{})]})}),e.jsxs(N,{variant:"outline",size:"sm",onClick:()=>n(d),className:"mt-2",children:[e.jsx($e,{className:"h-4 w-4 mr-1"})," 移除"]})]},u.id))}),e.jsxs(N,{type:"button",variant:"outline",onClick:()=>r({attr:"",level:1}),children:[e.jsx(Fe,{className:"h-4 w-4 mr-1"})," 添加过滤条件"]})]})},Na=({onSearch:i})=>{const l=le({resolver:ne(ya),defaultValues:{server:"",supportLevel:0,p0:[],p1:[]}}),c=r=>{var u,d,o,s;let n={attrs:[],levels:[]};(u=r.player0)!=null&&u.id&&(n.attrs.push("playerId0"),n.levels.push(r.player0.id)),r.supportLevel&&(n.attrs.push("supportLevel"),n.levels.push(r.supportLevel)),(d=r.support)!=null&&d.id&&(n.attrs.push("supportId"),n.levels.push(r.support.id)),(o=r.p0)==null||o.forEach(a=>{D[a.attr]?(n.blue0=a.attr,n.attrs.push("blueLevel0"),n.levels.push(a.level)):z[a.attr]?(n.red0=a.attr,n.attrs.push("redLevel0"),n.levels.push(a.level)):a.attr==="uraLevel"&&(n.attrs.push("uraLevel0"),n.levels.push(a.level))}),(s=r.p1)==null||s.forEach(a=>{n.attrs.push(a.attr),n.levels.push(a.level)}),r.server&&(n.attrs.push("server"),n.levels.push(r.server)),i(n)},p=()=>l.reset();return e.jsx(te,{...l,children:e.jsxs("form",{onSubmit:l.handleSubmit(c),className:"space-y-6",children:[e.jsx(L,{control:l.control,name:"server",render:({field:r})=>e.jsxs(j,{children:[e.jsx(b,{children:"区服"}),e.jsx(g,{children:e.jsx(M,{onValueChange:r.onChange,defaultValue:r.value,className:"flex gap-2",children:ba.map(n=>e.jsxs(j,{className:"flex items-center space-x-1",children:[e.jsx(g,{children:e.jsx(A,{value:n.value})}),e.jsx(b,{className:"font-normal",children:n.label})]},n.value))})}),e.jsx(k,{})]})}),e.jsx(L,{control:l.control,name:"player0",render:({field:r})=>e.jsxs(j,{children:[e.jsx(b,{children:"角色"}),e.jsx(g,{children:e.jsx(oe,{value:r.value,onChange:n=>r.onChange(n)})}),e.jsx(k,{})]})}),e.jsxs("div",{children:[e.jsx("h4",{className:"mb-2",children:"蓝色/红色/URA因子"}),e.jsx(Z,{name:"p0",max:3,control:l.control})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"mb-2",children:"总计"}),e.jsx(Z,{name:"p1",max:9,control:l.control})]}),e.jsx(L,{control:l.control,name:"support",render:({field:r})=>e.jsxs(j,{children:[e.jsx(b,{children:"支援卡"}),e.jsx(g,{children:e.jsx(ie,{value:r.value,onChange:n=>r.onChange(n)})}),e.jsx(k,{})]})}),e.jsx(L,{control:l.control,name:"supportLevel",render:({field:r})=>e.jsxs(j,{children:[e.jsx(b,{children:"突破等级"}),e.jsx(g,{children:e.jsx("div",{className:"flex items-center gap-1",children:[...Array(4)].map((n,u)=>e.jsx(N,{variant:r.value>u?"default":"outline",size:"sm",type:"button",onClick:()=>r.onChange(u+1),children:u+1},u))})}),e.jsx(k,{})]})}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(N,{type:"button",variant:"outline",onClick:p,children:"重置"}),e.jsx(N,{type:"submit",children:"搜索"})]})]})})},K=({id:i})=>{const l=de();if(!l)return null;const c=l.get("players").find({id:i}).value();return e.jsx(ce,{src:c==null?void 0:c.imgUrl,width:80})},wa=({id:i})=>{const l=de();if(!l)return null;const c=l.get("supports").find({id:i}).value();return e.jsx(ce,{src:c==null?void 0:c.imgUrl,width:80})},Ca=({data:i,total:l,onChange:c,onLike:p,onDislike:r,onDelete:n,userId:u})=>{var s;const d=[{accessorKey:"gameId",header:"玩家id",cell:({row:a})=>e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:a.original.gameId}),e.jsx(Ve.CopyToClipboard,{text:a.original.gameId,onCopy:()=>R.info("复制成功"),children:e.jsx(N,{variant:"ghost",size:"icon",className:"h-6 w-6",children:e.jsx(Ge,{className:"h-4 w-4"})})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>p(a.original),children:e.jsx(Je,{className:"h-4 w-4"})}),e.jsx("span",{children:a.original.likes})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>r(a.original),children:e.jsx(Ze,{className:"h-4 w-4"})}),e.jsx("span",{children:a.original.dislikes})]}),a.original.userId===u&&e.jsx(N,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>n(a.original),children:e.jsx(ea,{className:"h-4 w-4"})})]})},{accessorKey:"playerId0",header:"主要",cell:({row:a})=>e.jsx(K,{id:a.original.playerId0})},{accessorKey:"blue0",header:"蓝色因子",cell:({row:a})=>e.jsx("span",{className:"whitespace-nowrap",children:`${D[a.original.blue0]}  ${a.original.blueLevel0}`})},{accessorKey:"red0",header:"红色因子",cell:({row:a})=>e.jsx("span",{className:"whitespace-nowrap",children:`${z[a.original.red0]}  ${a.original.redLevel0}`})},{accessorKey:"greenLevel0",header:"绿色因子",cell:({row:a})=>e.jsx("span",{className:"whitespace-nowrap",children:`固有  ${a.original.greenLevel0}`})},{accessorKey:"uraLevel0",header:"URA",cell:({row:a})=>e.jsx("span",{className:"whitespace-nowrap",children:a.original.uraLevel0?`URA  ${a.original.uraLevel0}`:""})},{accessorKey:"playerId1",header:"父辈1",cell:({row:a})=>e.jsx(K,{id:a.original.playerId1})},{accessorKey:"playerId2",header:"父辈2",cell:({row:a})=>e.jsx(K,{id:a.original.playerId2})},{id:"allBlue",header:"总计蓝色",cell:({row:a})=>e.jsx("div",{className:"flex flex-col",children:Object.keys(D).map(t=>a.original[t]&&e.jsx("span",{className:"whitespace-nowrap",children:`${D[t]}  ${a.original[t]}`},t))})},{id:"allRed",header:"总计红色",cell:({row:a})=>e.jsx("div",{className:"flex flex-col",children:Object.keys(z).map(t=>a.original[t]&&e.jsx("span",{className:"whitespace-nowrap",children:`${z[t]}  ${a.original[t]}`},t))})},{accessorKey:"uraLevel",header:"总计URA"},{accessorKey:"white",header:"总计白色"},{accessorKey:"supportId",header:"支援卡",cell:({row:a})=>e.jsx(wa,{id:a.original.supportId})},{accessorKey:"supportLevel",header:"突破等级",cell:({row:a})=>e.jsx("div",{className:"flex",children:[...Array(4)].map((t,m)=>e.jsx("div",{className:`h-4 w-4 rounded-full mx-0.5 ${m<a.original.supportLevel?"bg-primary":"bg-muted"}`},m))})}],o=Ue({data:i,columns:d,getCoreRowModel:Oe(),getPaginationRowModel:Ke(),manualPagination:!0,pageCount:Math.ceil(l/10),state:{pagination:{pageIndex:0,pageSize:10}},onPaginationChange:a=>{const t=typeof a=="function"?a({pageIndex:0,pageSize:10}):a;c({current:t.pageIndex+1,pageSize:t.pageSize,total:l})}});return e.jsxs("div",{className:"rounded-md border",children:[e.jsxs(Pe,{children:[e.jsx(Ee,{children:o.getHeaderGroups().map(a=>e.jsx(U,{children:a.headers.map(t=>e.jsx(Ae,{children:X(t.column.columnDef.header,t.getContext())},t.id))},a.id))}),e.jsx(Te,{children:(s=o.getRowModel().rows)!=null&&s.length?o.getRowModel().rows.map(a=>e.jsx(U,{children:a.getVisibleCells().map(t=>e.jsx(H,{children:X(t.column.columnDef.cell,t.getContext())},t.id))},a.id)):e.jsx(U,{children:e.jsx(H,{colSpan:d.length,className:"h-24 text-center",children:"暂无数据"})})})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-2 p-4",children:[e.jsx(N,{variant:"outline",size:"sm",onClick:()=>o.previousPage(),disabled:!o.getCanPreviousPage(),children:"上一页"}),e.jsx(N,{variant:"outline",size:"sm",onClick:()=>o.nextPage(),disabled:!o.getCanNextPage(),children:"下一页"})]})]})};function Y({className:i,...l}){return e.jsx("div",{"data-slot":"card",className:$("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",i),...l})}function J({className:i,...l}){return e.jsx("div",{"data-slot":"card-header",className:$("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",i),...l})}function Q({className:i,...l}){return e.jsx("div",{"data-slot":"card-title",className:$("leading-none font-semibold",i),...l})}function ee({className:i,...l}){return e.jsx("div",{"data-slot":"card-content",className:$("px-6",i),...l})}const Aa=()=>{const[i,l]=y.useState(!1),[c,p]=y.useState([]),[r,n]=y.useState(0),[u,d]=y.useState({}),o=re.get("userId").value(),s=()=>l(!0),a=()=>l(!1),t=()=>{m({attrs:["userId"],levels:[o]})},m=async C=>{d(C);try{const I=await T.post("https://urarawin-worker.urarawin.workers.dev/api/sqlite/search",C);I.data&&(I.data.count?(p(I.data.list),n(I.data.count)):(p([]),n(0),R.info("暂无数据")))}catch{R.error("搜索失败")}},v=C=>{m({...u,count:C.total,offset:C.current*10-10})},w=async C=>{if(!o){R.info("刷新后重试");return}try{(await T.post("https://urarawin-worker.urarawin.workers.dev/api/sqlite/like",{id:C.id,userId:o})).data&&(R.info("操作成功"),p(E=>E.map(S=>S.id===C.id?{...S,likes:S.likes+1}:S)))}catch{R.error("操作失败")}},x=async C=>{if(!o){R.info("刷新后重试");return}try{(await T.post("https://urarawin-worker.urarawin.workers.dev/api/sqlite/dislike",{id:C.id,userId:o})).data&&(R.info("操作成功"),p(E=>E.map(S=>S.id===C.id?{...S,dislikes:S.dislikes+1}:S)))}catch{R.error("操作失败")}},P=async C=>{try{(await T.post("https://urarawin-worker.urarawin.workers.dev/api/sqlite/delete",C)).data&&(R.info("成功删除"),p(E=>E.filter(S=>S.id!==C.id)),n(E=>E-1))}catch{R.error("删除失败")}};return e.jsxs(e.Fragment,{children:[e.jsx(De,{children:e.jsx("title",{children:"分享 - 乌拉拉大胜利 - 赛马娘资料站"})}),e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsxs(Y,{children:[e.jsx(J,{children:e.jsx(Q,{children:"过滤条件"})}),e.jsxs(ee,{className:"space-y-4",children:[e.jsx(Na,{onSearch:m}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(N,{onClick:s,children:"配置我的种子"}),e.jsx(N,{variant:"outline",onClick:t,children:"查看我的种子"})]})]})]}),e.jsxs(Y,{children:[e.jsx(J,{children:e.jsx(Q,{children:"结果"})}),e.jsx(ee,{children:e.jsx(Ca,{data:c,total:r,onChange:v,onLike:w,onDislike:x,onDelete:P,userId:o})})]})]}),e.jsx(qe,{open:i,onOpenChange:l,children:e.jsx(Be,{className:"sm:max-w-[80%]",children:e.jsx(ga,{onFinish:a})})})]})};export{Aa as default};
