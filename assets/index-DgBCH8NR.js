import{G as re,r as p,u as ie,I as ae,s as m,j as t,v as z,B as f}from"./index-Cv25-zft.js";import{P as L,s as ne}from"./index-T9_PuU5m.js";import{u as oe}from"./index-B41NDl_D.js";import{S as le}from"./SupportListWithFilter-CoNoIWCA.js";import{R as ce,a as pe,P as ue}from"./PlayerList-BuzkpSoc.js";import{C as de,c as he,_ as v,a as _,H as me}from"./Helmet-CixuOQ1v.js";import{P as U}from"./index-u5xsggtp.js";import{R as $,C as E,M as B}from"./index-DYCoQkE9.js";import"./ActionButton-Bs9HjAjk.js";import"./useViewport-Dw4cCIh0.js";/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],ge=re("square-pen",fe);var ye=function(i,a){var g={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&a.indexOf(n)<0&&(g[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,n=Object.getOwnPropertySymbols(i);d<n.length;d++)a.indexOf(n[d])<0&&Object.prototype.propertyIsEnumerable.call(i,n[d])&&(g[n[d]]=i[n[d]]);return g},xe=function(a){var g=p.useContext(de),n=g.getPrefixCls,d=g.direction,S=a.prefixCls,P=a.type,x=P===void 0?"horizontal":P,b=a.orientation,y=b===void 0?"center":b,s=a.orientationMargin,o=a.className,C=a.children,h=a.dashed,k=a.plain,I=ye(a,["prefixCls","type","orientation","orientationMargin","className","children","dashed","plain"]),l=n("divider",S),O=y.length>0?"-".concat(y):y,R=!!C,D=y==="left"&&s!=null,w=y==="right"&&s!=null,j=he(l,"".concat(l,"-").concat(x),v(v(v(v(v(v(v({},"".concat(l,"-with-text"),R),"".concat(l,"-with-text").concat(O),R),"".concat(l,"-dashed"),!!h),"".concat(l,"-plain"),!!k),"".concat(l,"-rtl"),d==="rtl"),"".concat(l,"-no-default-orientation-margin-left"),D),"".concat(l,"-no-default-orientation-margin-right"),w),o),F=_(_({},D&&{marginLeft:s}),w&&{marginRight:s});return p.createElement("div",_({className:j},I,{role:"separator"}),C&&x!=="vertical"&&p.createElement("span",{className:"".concat(l,"-inner-text"),style:F},C))};const Ne=()=>{const{t:i}=ie(),a=ae(),[g,n]=p.useState(!1),[d,S]=p.useState(!1),[P,x]=p.useState(!1),[b,y]=p.useState(1),s=m.get("selected").value(),[o,C]=p.useState(s.supports),[h,k]=p.useState(s.player),[I,l]=p.useState(s.raceFilterCondition||{distanceType:[],grade:[],ground:[]}),[O,R]=p.useState(s.filterRace||{}),[D,w]=p.useState(m.get("myDecks").value()),j=oe();if(!j)return null;const F=j.get("races").value(),V=()=>{S(!0)},T=()=>{S(!1)},H=e=>{S(!1),k(e),s.player=e,m.get("selected").assign(s).write(),T()},q=e=>{n(!0),x(!0),y(e)},G=e=>{n(!1),x(!0),y(e)},N=()=>{x(!1)},W=e=>{let r={};r[b]=e,C(Object.assign({},o,r)),x(!1),s.supports[b]=e,m.get("selected").assign(s).write(),N()},A=e=>{a(`/support-detail/${e.id}`),N()},M=e=>{let r={imgUrls:[],supportsId:[]};h.id&&(r.playerId=h.id,r.imgUrls.push(h.imgUrl)),[0,1,2,3,4,5].forEach(c=>{o[c]&&o[c].id?(r.imgUrls.push(o[c].imgUrl),r.supportsId.push(o[c].id)):r.supportsId.push(null)}),e?m.get("myDecks").find({id:e.id}).assign(r).write():(r.id=ne.generate(),m.get("myDecks").push(r).write()),w([...m.get("myDecks").value()])},J=e=>{s.supports={0:{},1:{},2:{},3:{},4:{},5:{}},s.player={},e.playerId&&(s.player=j.get("players").find({id:e.playerId}).value()),k(s.player),e.supportsId.forEach((r,c)=>{r&&(s.supports[c]=j.get("supports").find({id:r}).value())}),C({...s.supports}),j.get("selected").assign(s).write()},K=e=>{m.get("myDecks").remove({id:e.id}).write(),w([...m.get("myDecks").value()])},Q=e=>{l(e);let r=Object.values(e).some(u=>u.length>0)?Object.entries(e).filter(([,u])=>u.length>0).reduce((u,[ee,te])=>u.filter(se=>te.includes(se[ee])),F):[],c={};for(let u of r)c[u.dateNum]?c[u.dateNum].push(u.id):c[u.dateNum]=[u.id];R(c),s.raceFilterCondition=e,s.filterRace=c,m.get("selected").assign({...s}).write()},X=e=>{a(`/support-detail/${e}`)},Y=e=>{a(`/player-detail/${e}/1`)},Z=()=>{a("/buff")};return t.jsxs(t.Fragment,{children:[t.jsx(me,{children:t.jsx("title",{children:"育成 - 乌拉拉大胜利 - 赛马娘资料站"})}),t.jsxs("div",{style:{display:"flex",justifyContent:"center"},children:[h.imgUrl&&t.jsx("img",{src:z+h.imgUrl,alt:h.imgUrl,width:"128",onClick:()=>Y(h.id)}),t.jsxs("div",{className:"flex-auto flex flex-wrap items-center",children:[t.jsx(f,{size:"sm",buttonType:"outline",onClick:V,children:i("选择马娘")}),t.jsx(f,{size:"sm",buttonType:"outline",onClick:G,children:i("支援卡查询")}),t.jsx(f,{size:"sm",buttonType:"outline",onClick:Z,children:i("BUFF")}),t.jsx(U,{trigger:"click",content:t.jsx(ce,{onChange:Q,raceFilterCondition:I}),children:t.jsx(f,{children:i("比赛")})}),t.jsx(U,{trigger:"click",width:"80%",content:t.jsxs(t.Fragment,{children:[t.jsx(f,{size:"sm",buttonType:"outline",onClick:()=>M(),children:i("保存为新卡组")}),D.map(e=>t.jsxs($,{children:[e.imgUrls.map(r=>t.jsx(E,{span:3,children:t.jsx("img",{src:z+r,alt:r,width:"100"})},r)),t.jsxs(E,{span:3,children:[t.jsx(f,{size:"sm",buttonType:"outline",type:"primary",onClick:()=>J(e),children:i("读取卡组")}),t.jsx(L,{title:"确认覆盖？",onConfirm:()=>M(e),children:t.jsx(f,{size:"sm",buttonType:"outline",danger:!0,type:"dashed",children:i("覆盖卡组")})}),t.jsx(L,{title:"确认删除？",onConfirm:()=>K(e),children:t.jsx(f,{size:"sm",buttonType:"outline",danger:!0,type:"dashed",children:i("删除卡组")})})]})]},e.id))]}),children:t.jsx(f,{children:i("我的卡组")})})]})]}),t.jsx($,{justify:"space-around",children:[0,1,2,3,4,5].map(e=>t.jsxs(E,{span:7,style:{},children:[t.jsx(f,{size:"sm",buttonType:"outline",icon:t.jsx(ge,{}),onClick:()=>q(e),children:i("选择支援卡")}),o[e]&&o[e].id&&t.jsx("img",{src:z+o[e].imgUrl,alt:o[e].name,width:"100%",onClick:()=>X(o[e].id)})]},e))}),t.jsx(xe,{children:"比赛"}),t.jsx("div",{style:{overflow:"auto",paddingTop:"10px",width:"100%",height:"400px"},children:t.jsx(pe,{raceList:h.raceList,filterRace:O})}),t.jsx(B,{visible:d,onOk:T,onCancel:T,footer:null,width:"100%",bodyStyle:{maxHeight:"80vh",overflow:"auto"},children:t.jsx(ue,{sortFlag:!0,onClick:H})}),t.jsx(B,{visible:P,onOk:N,onCancel:N,footer:null,width:"100%",bodyStyle:{height:"80vh",overflow:"auto"},children:t.jsx(le,{formName:"nurSupMo",onClick:g?W:A,sortFlag:!0})})]})};export{Ne as default};
